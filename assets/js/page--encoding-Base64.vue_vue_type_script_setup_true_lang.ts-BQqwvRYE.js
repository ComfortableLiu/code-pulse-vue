import{g as w}from"./js-base64-BbY-I90a.js";import{b as A}from"./codemirror-hwvxDye2.js";import{f as H,p as U,a as $,b as I,N as O}from"./prettier-B5g_hT_O.js";import{z as C,A as W,B as D,C as G,S as k,D as L,F as u,G as v,E as M,H as R,j as K,I as Q}from"./@codemirror-BPrm9nb3.js";import{d as j,r as g,o as X,w as Y,f as Z,S as T,U as S,V as f,W as q,X as J,Y as P,Z as h,_ as V,$ as _,G as ee,c,u as B}from"./@vue-0fNgdcnR.js";import{_ as te}from"./page--encoding-Base64.vue-DvxsG8iQ.js";import{A as oe,a as ae}from"./@icon-park-CCGo8PkQ.js";async function ne(d,a){return!a||a==="text"?d:H(d,{parser:a,tabWidth:2,singleQuote:!0,semi:!1,plugins:[U,$,I,O]})}const se={class:"extension-action"},re=j({__name:"CodeEditor",props:{value:{},language:{},style:{},containerStyle:{},showFormat:{type:Boolean}},emits:["update:value","formatError"],setup(d,{expose:a,emit:i}){const m={javascript:{extension:C({typescript:!1,jsx:!0}),format:"babel"},json:{extension:R(),format:"json"},html:{extension:G(),format:"html"},css:{extension:D(),format:"css"},markdown:{extension:W(),format:"markdown"},text:{extension:void 0,format:"text"},typescript:{extension:C({typescript:!0,jsx:!0}),format:"typescript"}},n=d,p=i,s=g(null);let t;const r=g(n.value),x=k.define({map:(e,o)=>e.map(o)}),y=k.define(),F=L.define({create(){return v.none},update(e,o){e=e.map(o.changes);for(const l of o.effects)l.is(x)?e=e.update({add:[l.value]}):l.is(y)&&(e=v.none);return e},provide:e=>u.decorations.from(e)});X(()=>{t=new u({state:M.create({doc:n.value||"",extensions:[A,m[n.language].extension,u.lineWrapping,u.updateListener.of(e=>{e.docChanged&&(r.value=e.state.doc.toString(),p("update:value",r.value))}),F,K({activateOnTyping:!0,maxRenderedOptions:20,defaultKeymap:!0})].filter(e=>!!e)}),parent:s.value})}),Y(()=>n.value,e=>{if(e!==r.value&&t){const o=t.state.update({changes:{from:0,to:t.state.doc.length,insert:e}});t.dispatch(o)}});const b=async()=>{if(t)try{const e=t.state.doc.toString(),o=await ne(e,m[n.language].format);t.dispatch({changes:{from:0,to:e.length,insert:o}}),p("formatError",void 0)}catch(e){const o=e.loc.start.line;N(o),p("formatError",e)}},N=e=>{if(e===0){t.dispatch({effects:y.of(null)});return}const o=t.state.doc.line(e),z=v.line({attributes:{style:"background-color: rgb(255, 229, 224)"}}).range(o.from);t.dispatch({effects:[x.of(z),u.scrollIntoView(Q.range(t.state.doc.line(e).from,t.state.doc.line(e).to))]})};return a({doFormatCode:b}),Z(()=>{t&&t.destroy()}),(e,o)=>{const l=V("a-button");return _(),T("div",{class:"container",style:S(n.containerStyle)},[f("div",{ref_key:"editorContainer",ref:s,class:"editor",style:S(n.style)},null,4),f("div",se,[n.showFormat?(_(),q(l,{key:0,onClick:b},{default:h(()=>o[0]||(o[0]=[ee(" 格式化 ")])),_:1,__:[0]})):J("",!0),P(e.$slots,"button",{},void 0)])],4)}}}),E=te(re,[["__scopeId","data-v-4e44e2a7"]]),ie={class:"container"},le={class:"operation-container"},ce={class:"btn-group"},he=j({__name:"Base64",setup(d){const a=g(""),i=g(""),m=()=>{a.value=w.encode(i.value)},n=()=>{i.value=w.decode(a.value)};return(p,s)=>{const t=V("a-button");return _(),T("div",ie,[s[2]||(s[2]=f("h1",null,"Base64编码",-1)),f("div",le,[c(E,{language:"text",value:i.value,"onUpdate:value":s[0]||(s[0]=r=>i.value=r)},null,8,["value"]),f("div",ce,[c(t,{onClick:m},{default:h(()=>[c(B(oe),{theme:"two-tone",size:"24",fill:["#000","#fff"]})]),_:1}),c(t,{onClick:n},{default:h(()=>[c(B(ae),{theme:"two-tone",size:"24",fill:["#000","#fff"]})]),_:1})]),c(E,{language:"text",value:a.value,"onUpdate:value":s[1]||(s[1]=r=>a.value=r)},null,8,["value"])])])}}});export{E as C,he as _};
