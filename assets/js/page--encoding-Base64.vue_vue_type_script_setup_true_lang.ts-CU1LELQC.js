import{g as C}from"./js-base64-BbY-I90a.js";import{b as N}from"./codemirror-dX7tu23H.js";import{f as z,p as A,a as H,b as U,N as I}from"./prettier-B5g_hT_O.js";import{z as W,A as $,B as D,C as G,S as y,D as L,F as f,G as _,E as M,H as O,I as Q}from"./@codemirror-oX9MkQRm.js";import{d as E,r as p,o as R,w as X,f as Y,S as T,U as k,V as m,c as r,W as x,X as g,Y as b,Z,_ as q,$ as J,G as K,u as S}from"./@vue-D99K_9aj.js";import{_ as P}from"./page--encoding-Base64.vue-CXntCOjN.js";import{A as tt,a as et}from"./@icon-park-CUVsHzwu.js";async function ot(d,a){return!a||a==="text"?d:z(d,{parser:a,tabWidth:2,singleQuote:!0,semi:!1,plugins:[A,H,U,I]})}const at=E({__name:"CodeEditor",props:{value:{},language:{},style:{},containerStyle:{},showFormat:{type:Boolean}},emits:["update:value","formatError"],setup(d,{emit:a}){const s={javascript:{extension:G(),format:"babel"},json:{extension:O(),format:"json"},html:{extension:D(),format:"html"},css:{extension:$(),format:"css"},markdown:{extension:W(),format:"markdown"},text:{extension:void 0,format:"text"}},n=d,u=a,v=p(null);let e;const i=p(n.value),l=y.define({map:(t,o)=>t.map(o)}),w=y.define(),V=L.define({create(){return _.none},update(t,o){t=t.map(o.changes);for(const c of o.effects)c.is(l)?t=t.update({add:[c.value]}):c.is(w)&&(t=_.none);return t},provide:t=>f.decorations.from(t)});R(()=>{e=new f({state:M.create({doc:n.value||"",extensions:[N,s[n.language].extension,f.lineWrapping,f.updateListener.of(t=>{t.docChanged&&(i.value=t.state.doc.toString(),u("update:value",i.value))}),V].filter(t=>!!t)}),parent:v.value})}),X(()=>n.value,t=>{if(t!==i.value&&e){const o=e.state.update({changes:{from:0,to:e.state.doc.length,insert:t}});e.dispatch(o)}});const j=async()=>{if(e)try{const t=e.state.doc.toString(),o=await ot(t,s[n.language].format);e.dispatch({changes:{from:0,to:t.length,insert:o}}),u("formatError",void 0)}catch(t){const o=t.loc.start.line;F(o),u("formatError",t)}},F=t=>{if(t===0){e.dispatch({effects:w.of(null)});return}const o=e.state.doc.line(t),h=_.line({attributes:{style:"background-color: rgb(255, 229, 224)"}}).range(o.from);e.dispatch({effects:l.of(h)}),e.dispatch({effects:[f.scrollIntoView(Q.range(e.state.doc.line(t).from,e.state.doc.line(t).to))]})};return Y(()=>{e&&e.destroy()}),(t,o)=>{const c=x("a-button"),h=x("a-button-group");return b(),T("div",{class:"container",style:k(n.containerStyle)},[m("div",{ref_key:"editorContainer",ref:v,class:"editor",style:k(n.style)},null,4),r(h,null,{default:g(()=>[n.showFormat?(b(),Z(c,{key:0,onClick:j},{default:g(()=>o[0]||(o[0]=[K(" 格式化 ")])),_:1,__:[0]})):q("",!0),J(t.$slots,"button",{},void 0,!0)]),_:3})],4)}}}),B=P(at,[["__scopeId","data-v-11bd3f23"]]),nt={class:"container"},st={class:"operation-container"},rt={class:"btn-group"},pt=E({__name:"Base64",setup(d){const a=p(""),s=p(""),n=()=>{a.value=C.encode(s.value)},u=()=>{s.value=C.decode(a.value)};return(v,e)=>{const i=x("a-button");return b(),T("div",nt,[e[2]||(e[2]=m("h1",null,"Base64编码",-1)),m("div",st,[r(B,{language:"text",value:s.value,"onUpdate:value":e[0]||(e[0]=l=>s.value=l)},null,8,["value"]),m("div",rt,[r(i,{onClick:n},{default:g(()=>[r(S(tt),{theme:"two-tone",size:"24",fill:["#000","#fff"]})]),_:1}),r(i,{onClick:u},{default:g(()=>[r(S(et),{theme:"two-tone",size:"24",fill:["#000","#fff"]})]),_:1})]),r(B,{language:"text",value:a.value,"onUpdate:value":e[1]||(e[1]=l=>a.value=l)},null,8,["value"])])])}}});export{B as C,pt as _};
